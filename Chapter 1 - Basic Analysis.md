# Basic Static Techniques
## Antivirus scanning 
Rely on different antivirus programs, such as common VirusTotal (http://www.virustotal.com)

## Hashing 
Check hash signatures and compare with originals to determine if file had been tampered with 

![](screenshots/Pasted%20image%2020220407194110.png)

GUI-based WinMD5 calculator can calculate and display hashes for several files at one time

![](screenshots/Pasted%20image%2020220407194204.png)


## Finding Strings
Linux `string` program is useful to identify if program contains malware

Strings are typically stored in ASCII or Unicode format
- ASCII - 1 byte (8bit) e.g all your standard characters A-Z and other control char. 
 
![](screenshots/Pasted%20image%2020220407194507.png)

- Unicode - 2 byte (16bit) e.g. caters to more characters and symbols 

![](screenshots/Pasted%20image%2020220407194527.png)

- Programs with malware may typically contain few 'Strings that make sense'
- Malware writer may try to obsfucate or hide the execution. In the below example are tell tale signs of a malware. 

![](screenshots/Pasted%20image%2020220407194705.png)

`99.124.22.1` - IP address 
`GetLayout` & `SetLayout` -  Windows Functions used by windows graphics library
`GDI32.DLL` - common windows DLL library used by graphics program
`...Send Mail failed to send message` - Malware possibly using mail to send messages.

## Pack and Obsfucated Malware
Malware writers often use (1) packing (2) obfuscation:
- **Packed** programs - compressed and may not be analyse
- **obfuscated** programs has execution that are hidden.

If you run `Strings` program on the malware and notice that there are only a **few strings** it may suggest that it is malicious, and may need more than static analysis to investigate further.

> Pack or obsfucated code often include `LoadLibrary` and `GetProcAddress` that are used to load and gain access to additional info

Example of a packed file:

![](screenshots/Pasted%20image%2020220407200422.png)

### PEiD - Detecting packed files
Use PEiD program to detect packed files. The following shows PEiD found file is packed with `UPX version 0.89.6....`. UPX is a popular Packing program, to unpack it use UPX (from sourceforge) and run it like`upx -d PackedProgram.exe` 

![](screenshots/Pasted%20image%2020220407200732.png)

> use latest PEiD version, some older versions are vulnerable. Clever malware writers can write a program to exploit the malware analyst machine for example by exploiting the program's buffer overflow, so always use the newer versions

## Portable Executable (PE) file Format
> PE header information is of great value to a malware analyst
- PE file format is used by windows exe, object code and DLLs. 
- PE is a data structure containing info for Windows OS loader to manage executable code.
- Majority all executable code loaded by windows are PE formats
